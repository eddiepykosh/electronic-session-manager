<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ELECTRONic Session Manager</title>
    <link rel="stylesheet" href="../styles/main.css" />
  </head>
  <body>
    <div id="app">
      <header class="app-header">
        <div class="header-content">
          <div class="header-left">
            <h1>ELECTRONic Session Manager</h1>
            <p>AWS EC2 Instance Management Tool</p>
          </div>
          <div class="header-right">
            <div class="header-controls-panel">
              <div class="dark-mode-toggle">
                <label for="dark-mode-switch" class="dark-mode-label">
                  <span class="toggle-icon">üåô</span>
                  <span class="toggle-text">Dark Mode</span>
                </label>
                <input type="checkbox" id="dark-mode-switch" class="dark-mode-switch">
              </div>
              <div class="profile-selector">
                <label for="profile-select">AWS Profile:</label>
                <select id="profile-select" class="profile-dropdown">
                  <option value="">Loading profiles...</option>
                </select>
                <div id="profile-status" class="profile-status">
                  <span class="status-indicator"></span>
                  <span class="status-text">Loading...</span>
                </div>
                <button id="manage-profiles" class="btn-manage-profiles">‚öôÔ∏è Manage Profiles</button>
              </div>
            </div>
          </div>
        </div>
      </header>
      
      <main class="app-main">
        <div class="sidebar">
          <h2>Instances</h2>
          <div class="instance-controls">
            <button id="refresh-instances" class="btn-primary">üîÑ Refresh Instances</button>
          </div>
          <div id="instance-list">
            <!-- Instance list will be populated here -->
          </div>
        </div>
        
        <div class="content">
          <!-- Tab Navigation -->
          <div class="tab-navigation">
            <button class="tab-button active" data-tab="instances">Instances</button>
            <button class="tab-button" data-tab="console">Console</button>
          </div>
          
          <!-- Tab Content -->
          <div class="tab-content">
            <!-- Instances Tab -->
            <div id="instances-tab" class="tab-panel active">
              <div id="instance-details">
                <!-- Instance details will be shown here -->
                <p>Select an instance to view details</p>
              </div>
            </div>
            
            <!-- Console Tab -->
            <div id="console-tab" class="tab-panel">
              <div class="console-header">
                <h3>Application Console</h3>
                <div class="console-controls">
                  <button id="clear-console" class="btn-secondary">Clear</button>
                  <button id="export-logs" class="btn-secondary">Export</button>
                </div>
              </div>
              <div id="console-output" class="console-output">
                <!-- Console output will be displayed here -->
              </div>
            </div>
          </div>
        </div>
      </main>
      
      <!-- Status Bar -->
      <footer class="status-bar">
        <div class="status-bar-content">
          <div class="status-left">
            <div class="status-item">
              <span class="status-label">AWS CLI:</span>
              <span id="aws-cli-status" class="status-value">
                <span class="status-indicator"></span>
                <span class="status-text">Checking...</span>
              </span>
            </div>
            <div class="status-item">
              <span class="status-label">Profile:</span>
              <span id="current-profile-status" class="status-value">
                <span class="status-indicator"></span>
                <span class="status-text">None</span>
              </span>
            </div>
            <div class="status-item">
              <span class="status-label">Active Sessions:</span>
              <span id="active-sessions-status" class="status-value clickable">
                <span class="status-text">0</span>
                <span class="status-icon">üîó</span>
              </span>
            </div>
          </div>
          <div class="status-right">
            <div class="status-item">
              <span class="status-label">App Status:</span>
              <span id="app-status" class="status-value">
                <span class="status-indicator"></span>
                <span class="status-text">Ready</span>
              </span>
            </div>
            <div class="status-item">
              <span class="status-label">Last Update:</span>
              <span id="last-update-time" class="status-value">
                <span class="status-text">Never</span>
              </span>
            </div>
          </div>
        </div>
      </footer>
    </div>
    
    <!-- Profile Management Dialog -->
    <div id="profile-management-dialog" class="profile-dialog">
      <div class="profile-dialog-content">
        <div class="profile-dialog-header">
          <h2>üîß AWS Profile Management</h2>
          <button id="close-profile-dialog" class="btn-close">√ó</button>
        </div>
        
        <div class="profile-dialog-body">
          <!-- SSO Login Section -->
          <div class="profile-section">
            <h3>SSO Login</h3>
            <div class="sso-login-section">
              <p class="sso-description">Login to your AWS SSO profiles to access AWS resources.</p>
              <div class="sso-profiles-list" id="sso-profiles-list">
                <!-- SSO profiles will be populated here -->
              </div>
              <button id="refresh-sso-status" class="btn-secondary">üîÑ Refresh SSO Status</button>
            </div>
          </div>
          
          <!-- Create New Profile Section -->
          <div class="profile-section">
            <h3>Create New Profile</h3>
            <div class="profile-type-selector">
              <button class="profile-type-btn active" data-type="iam">IAM Profile</button>
              <button class="profile-type-btn" data-type="sso">SSO Profile</button>
            </div>
            
            <!-- IAM Profile Form -->
            <form id="iam-profile-form" class="profile-form active">
              <div class="form-group">
                <label for="iam-profile-name">Profile Name:</label>
                <input type="text" id="iam-profile-name" placeholder="e.g., production" required>
              </div>
              <div class="form-group">
                <label for="iam-access-key">Access Key ID:</label>
                <input type="text" id="iam-access-key" placeholder="AKIA..." required>
              </div>
              <div class="form-group">
                <label for="iam-secret-key">Secret Access Key:</label>
                <input type="password" id="iam-secret-key" placeholder="..." required>
              </div>
              <div class="form-group">
                <label for="iam-session-token">Session Token (Optional):</label>
                <input type="password" id="iam-session-token" placeholder="For temporary credentials...">
                <small class="form-help">Only required for temporary credentials (e.g., from AWS STS, IAM roles, etc.)</small>
              </div>
              <div class="form-group">
                <label for="iam-region">Region:</label>
                <select id="iam-region">
                  <option value="us-east-1">US East (N. Virginia) - us-east-1</option>
                  <option value="us-east-2">US East (Ohio) - us-east-2</option>
                  <option value="us-west-1">US West (N. California) - us-west-1</option>
                  <option value="us-west-2">US West (Oregon) - us-west-2</option>
                  <option value="us-gov-east-1">AWS GovCloud (US-East) - us-gov-east-1</option>
                  <option value="us-gov-west-1">AWS GovCloud (US-West) - us-gov-west-1</option>
                </select>
              </div>
              <button type="submit" class="btn-create-profile">Create IAM Profile</button>
            </form>
            
            <!-- SSO Profile Form -->
            <form id="sso-profile-form" class="profile-form">
              <div class="form-group">
                <label for="sso-profile-name">Profile Name:</label>
                <input type="text" id="sso-profile-name" placeholder="e.g., sso-dev" required>
              </div>
              <div class="form-group">
                <label for="sso-start-url">SSO Start URL:</label>
                <input type="url" id="sso-start-url" placeholder="https://your-portal.awsapps.com/start" required>
              </div>
              <div class="form-group">
                <label for="sso-region">SSO Region:</label>
                <select id="sso-region">
                  <option value="us-east-1">US East (N. Virginia) - us-east-1</option>
                  <option value="us-east-2">US East (Ohio) - us-east-2</option>
                  <option value="us-west-1">US West (N. California) - us-west-1</option>
                  <option value="us-west-2">US West (Oregon) - us-west-2</option>
                  <option value="us-gov-east-1">AWS GovCloud (US-East) - us-gov-east-1</option>
                  <option value="us-gov-west-1">AWS GovCloud (US-West) - us-gov-west-1</option>
                </select>
              </div>
              <div class="form-group">
                <label for="sso-account-id">Account ID:</label>
                <input type="text" id="sso-account-id" placeholder="123456789012" required>
              </div>
              <div class="form-group">
                <label for="sso-role-name">Role Name:</label>
                <input type="text" id="sso-role-name" placeholder="PowerUserRole" required>
              </div>
              <div class="form-group">
                <label for="sso-aws-region">Region:</label>
                <select id="sso-aws-region">
                  <option value="us-east-1">US East (N. Virginia) - us-east-1</option>
                  <option value="us-east-2">US East (Ohio) - us-east-2</option>
                  <option value="us-west-1">US West (N. California) - us-west-1</option>
                  <option value="us-west-2">US West (Oregon) - us-west-2</option>
                  <option value="us-gov-east-1">AWS GovCloud (US-East) - us-gov-east-1</option>
                  <option value="us-gov-west-1">AWS GovCloud (US-West) - us-gov-west-1</option>
                </select>
              </div>
              <button type="submit" class="btn-create-profile">Create SSO Profile</button>
            </form>
          </div>
          
          <!-- Existing Profiles Section -->
          <div class="profile-section">
            <h3>Existing Profiles</h3>
            <div id="existing-profiles-list" class="profiles-list">
              <!-- Profiles will be populated here -->
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Session Management Dialog -->
    <div id="session-management-dialog" class="session-dialog">
      <div class="session-dialog-content">
        <div class="session-dialog-header">
          <h2>üîó Active Port Forwarding Sessions</h2>
          <button id="close-session-dialog" class="btn-close">√ó</button>
        </div>
        
        <div class="session-dialog-body">
          <div id="active-sessions-list" class="sessions-list">
            <!-- Active sessions will be populated here -->
          </div>
          
          <div id="no-sessions-message" class="no-sessions-message">
            <p>No active port forwarding sessions</p>
          </div>
          
          <div class="session-dialog-actions">
            <button id="refresh-sessions-list" class="btn-secondary">üîÑ Refresh List</button>
            <button id="check-orphaned-sessions" class="btn-secondary">üîç Check for Orphaned Sessions</button>
            <button id="force-cleanup-sessions" class="btn-secondary">üßπ Force Cleanup All Sessions</button>
          </div>
        </div>
      </div>
    </div>
    
    <div id="notification-container"></div>
    <script type="module" src="./renderer.js"></script>
  </body>
</html>
